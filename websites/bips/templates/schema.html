{% extends "base.html" %}
{% from 'macro_schema_rel.html' import schema_relationnel with context %}
{% from 'macro_instances.html' import tab_instances with context %}
{% from 'macro_message.html' import print_message with context %}

{% block main_content %}
<h2>Tables dans le schéma {{ REQUEST_VARS['current_schema'] }}</h2>

{% if SESSION['schemas_to_tables_to_atts'][REQUEST_VARS['current_schema']]  %}
    <p class="pl4" style="font-size: larger; word-spacing: 2px; line-height: 1.5;">
    {% for table in SESSION['schemas_to_tables_to_atts'][REQUEST_VARS['current_schema']] %}
    {{ schema_relationnel(table, SESSION['schemas_to_tables_to_atts'][REQUEST_VARS['current_schema']][table]) }}
        <br>
    {% endfor %}
    </p>
{% else %}
    {{ print_message(REQUEST_VARS['message'], REQUEST_VARS['message_class']) }}
{% endif %}

<h2>Exécuter une requête SQL</h2>

{% include 'form_sql.html' %}

{% if REQUEST_VARS['message']  %}
    {{ print_message(REQUEST_VARS['message'], REQUEST_VARS['message_class']) }}
{% endif %}

{% if REQUEST_VARS.query_result and REQUEST_VARS.query_result.is_select_query %}
<p>
    {{ tab_instances(REQUEST_VARS['query_result'].result_attributes, REQUEST_VARS['query_result'].result_instances) }}
</p>
{% endif %}

{% endblock %}
